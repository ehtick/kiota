FROM mcr.microsoft.com/vscode/devcontainers/dotnetcore:5.0

# installs tools required for installation of other tools
RUN apt-get update \
    && apt-get dist-upgrade -y \
    && apt-get install wget apt-transport-https software-properties-common -y

# installs java
RUN wget -qO - https://adoptopenjdk.jfrog.io/adoptopenjdk/api/gpg/key/public | sudo apt-key add - \
    && apt-get update \
    && add-apt-repository --yes https://adoptopenjdk.jfrog.io/adoptopenjdk/deb/ \
    && apt-get update \
    && apt-get install unzip adoptopenjdk-16-hotspot -y
# leaving on java 16 until this gets completed https://github.com/adoptium/installer/issues/330

# installs gradle
RUN wget https://services.gradle.org/distributions/gradle-7.2-bin.zip -P /tmp \
    && unzip -d /opt/gradle /tmp/gradle-7.2-bin.zip \
    && ln -s /opt/gradle/gradle-7.2 /opt/gradle/latest \
    && echo "export GRADLE_HOME=/opt/gradle/latest" > /etc/profile.d/gradle.sh \
    && echo "export PATH=${GRADLE_HOME}/bin:${PATH}" >> /etc/profile.d/gradle.sh \
    && chmod +x /etc/profile.d/gradle.sh

# installs golang
RUN wget -c https://dl.google.com/go/go1.16.7.linux-amd64.tar.gz -O - | tar -xz -C /usr/local \
    && export PATH=$PATH:/usr/local/go/bin \
    && go get -v golang.org/x/tools/gopls

# installs node
RUN apt-get install nodejs npm -y \
    && npm i -g typescript eslint prettier

# installs powershell
RUN wget -q https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb \
    && dpkg -i packages-microsoft-prod.deb \
    && apt-get update \
    && add-apt-repository universe \
    && apt-get install -y powershell

# install ruby
RUN apt-get install ruby-full bundler -y

# install github CLI
RUN apt-key adv --keyserver keyserver.ubuntu.com --recv-key C99B11DEB97541F0 \
    && apt-add-repository https://cli.github.com/packages \
    && apt update \
    && apt install gh -y

# General updates for sanity
RUN apt-get dist-upgrade -y